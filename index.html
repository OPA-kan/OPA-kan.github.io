<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¥¿æ‘ã²ã‚ã‚†ãå­¦ï¼šè«–ç†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ v4.0 (Endless Debate)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap');
        
        :root {
            --hiroyuki-bg: #0f172a;
            --hiroyuki-accent: #3b82f6;
            --hiroyuki-warn: #ef4444;
            --hiroyuki-success: #10b981;
        }

        body {
            font-family: 'Fira Code', 'Noto Sans JP', monospace;
            background-color: var(--hiroyuki-bg);
            color: #f1f5f9;
        }

        .chat-bubble {
            position: relative;
            max-width: 85%;
            padding: 1rem;
            border-radius: 1rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .bubble-hiroyuki {
            background-color: rgba(30, 41, 59, 0.8);
            border-bottom-left-radius: 0;
            backdrop-filter: blur(10px);
        }

        .bubble-user {
            background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
            margin-left: auto;
            border-bottom-right-radius: 0;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .meter-fill {
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1), background-color 0.5s ease;
        }

        .shimmer-text {
            background: linear-gradient(90deg, #94a3b8, #ffffff, #94a3b8);
            background-size: 200% auto;
            color: transparent;
            -webkit-background-clip: text;
            background-clip: text;
            animation: shimmer 3s linear infinite;
        }

        @keyframes shimmer {
            to { background-position: 200% center; }
        }

        .typing-dot {
            display: inline-block;
            width: 4px;
            height: 4px;
            background-color: #94a3b8;
            border-radius: 50%;
            margin-right: 2px;
            animation: typing 1s infinite ease-in-out;
        }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-4px); }
        }

        .game-over-overlay {
            position: absolute;
            inset: 0;
            background: rgba(15, 23, 42, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 50;
            backdrop-filter: blur(8px);
            animation: scaleIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-2 md:p-4">

    <div class="max-w-2xl w-full bg-slate-900 rounded-3xl shadow-2xl overflow-hidden border border-slate-800 flex flex-col h-[95vh] md:h-[90vh] relative">
        
        <!-- Game Over Overlay (Hidden) -->
        <div id="game-over" class="game-over-overlay hidden p-8 text-center">
            <div id="result-emoji" class="text-7xl mb-6">ğŸ’€</div>
            <h2 id="result-title" class="text-3xl font-bold mb-4">è«–ç ´ã•ã‚Œã¾ã—ãŸ</h2>
            <div id="result-comment" class="bubble-hiroyuki p-6 rounded-2xl text-sm italic mb-8 border border-slate-700">
                ã€Œã¯ã„ã€ãŠç–²ã‚Œæ§˜ã§ã—ãŸã€‚æ™‚é–“ã®ç„¡é§„ã§ã—ãŸã­ã€‚ã€
            </div>
            <button onclick="resetGame()" class="bg-blue-600 hover:bg-blue-500 text-white px-8 py-3 rounded-full font-bold transition-all active:scale-95 shadow-lg">
                ã‚‚ã†ä¸€åº¦æŒ‘ã‚€
            </button>
        </div>

        <!-- Header -->
        <div class="p-4 md:p-6 bg-slate-800/80 border-b border-slate-700 flex flex-wrap items-center justify-between shrink-0 gap-4">
            <div class="flex items-center space-x-3">
                <div class="w-12 h-12 rounded-full bg-yellow-500 flex items-center justify-center text-2xl shadow-lg ring-4 ring-yellow-500/20">
                    ğŸ¤”
                </div>
                <div>
                    <h1 class="font-bold text-lg leading-tight shimmer-text">ã²ã‚ã‚†ãè«–ç†ã‚¨ãƒ³ã‚¸ãƒ³ v4.0</h1>
                    <p class="text-[10px] text-slate-400 font-mono" id="status-text">DEBATE_PHASE: ACTIVE</p>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-right">
                    <p class="text-[9px] uppercase tracking-tighter text-slate-500">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è«–ç†æ€§ (Logic Score)</p>
                    <div class="w-28 md:w-32 h-3 bg-slate-700 rounded-full overflow-hidden mt-1 border border-slate-600">
                        <div id="logic-meter" class="h-full bg-yellow-500 meter-fill w-[30%]"></div>
                    </div>
                </div>
                <div id="score-text" class="text-2xl font-bold text-yellow-500">30</div>
            </div>
        </div>

        <!-- Chat Area -->
        <div id="chat-window" class="flex-1 overflow-y-auto p-4 md:p-6 space-y-4 scroll-smooth bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-slate-800/20 via-transparent to-transparent text-sm md:text-base">
            <div class="bubble-hiroyuki chat-bubble leading-relaxed">
                ä½•ã‹ä¸»å¼µã—ã¦ã¿ã¦ãã ã•ã„<br>
                æœ€è¿‘ã®ãŠæ‚©ã¿ã¯ã€ã€ãŠè‚Œã®ä¹¾ç‡¥ã§ã™ã‚ˆã­ã€‚
            </div>
        </div>

        <!-- Typing Indicator -->
        <div id="typing-indicator" class="px-6 py-2 hidden shrink-0">
            <div class="bubble-hiroyuki chat-bubble inline-flex items-center space-x-1 py-2 px-4 border-none">
                <span class="typing-dot"></span>
                <span class="typing-dot"></span>
                <span class="typing-dot"></span>
            </div>
        </div>

        <!-- Input Area -->
        <div class="p-4 md:p-6 bg-slate-800/50 border-t border-slate-700 shrink-0">
            <form id="chat-form" class="flex space-x-2">
                <input 
                    type="text" 
                    id="user-input" 
                    placeholder="ä¸»å¼µã‚„åè«–ã‚’å…¥åŠ›..." 
                    class="flex-1 bg-slate-950 border border-slate-700 rounded-2xl px-5 py-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-blue-100"
                    required
                    autocomplete="off"
                >
                <button 
                    type="submit" 
                    id="submit-btn"
                    class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-4 rounded-2xl font-bold text-sm shadow-lg transition-all active:scale-[0.97]"
                >
                    è«–æˆ¦
                </button>
            </form>
            <p class="text-[9px] text-slate-500 mt-3 text-center font-mono italic">
                å‹åˆ©æ¡ä»¶: Logic 100 | æ•—åŒ—æ¡ä»¶: Logic 0
            </p>
        </div>
    </div>

    <script>
        const form = document.getElementById('chat-form');
        const userInput = document.getElementById('user-input');
        const chatWindow = document.getElementById('chat-window');
        const typingIndicator = document.getElementById('typing-indicator');
        const logicMeter = document.getElementById('logic-meter');
        const scoreText = document.getElementById('score-text');
        const statusText = document.getElementById('status-text');
        const gameOverOverlay = document.getElementById('game-over');
        
        let logicScore = 30; // åˆæœŸå€¤
        let isGameOver = false;

        // ã²ã‚ã‚†ãã®ã‚¢ã‚¿ãƒƒã‚¯ï¼ˆé€šå¸¸æ™‚ï¼‰
        const HIROYUKI_PHRASES = [
            "ãã‚Œã£ã¦ã‚ãªãŸãŒãã†å®šç¾©ã—ã¦ã‚‹ã ã‘ã§ã™ã‚ˆã­ï¼Ÿè¨€è‘‰ã®è§£é‡ˆãªã‚“ã¦äººã«ã‚ˆã£ã¦é•ã†ã˜ã‚ƒãªã„ã§ã™ã‹ã€‚",
            "å®šç¾©ãŒæ›–æ˜§ãªè¨€è‘‰ã‚’ä¸¦ã¹ã¦æ­£ã—ã„ã£ã¦è¨€ã„å¼µã‚‹ã®ã€è¦‹ã¦ã¦æ¥ãšã‹ã—ããªã„ã§ã™ã‹ï¼Ÿ",
            "ãã®ã€è¨€è‘‰ã€ãŒæŒ‡ã—ã¦ã‚‹æ¦‚å¿µè‡ªä½“ã€ã‚ãªãŸã®è„³å†…ã«ã‚ã‚‹æ„Ÿæƒ³ã«éããªã„ã§ã™ã‚ˆã­ã€‚",
            "ãã®è¨ˆç®—ã®å‰æã«ãªã£ã¦ã‚‹å…¬ç†ç³»ã‚’æ¡ç”¨ã—ã¦ã‚‹ã®ã£ã¦ã€ã‚ãªãŸã®æ„Ÿæƒ³ã§ã™ã‚ˆã­ï¼Ÿ",
            "åˆ¥ã®å…¬ç†ç³»ã ã£ãŸã‚‰ãã®çµè«–ã£ã¦å¤‰ã‚ã£ã¡ã‚ƒã†ã¨æ€ã†ã‚“ã§ã™ã‘ã©ã€ãã“ç„¡è¦–ã—ã¦ã„ã„ã‚“ã§ã™ã‹ï¼Ÿ",
            "ãã‚Œã£ã¦ãƒšã‚¢ãƒã®å…¬ç†ã¨ã‹ã‚’ä¿¡ã˜ãŸã„ã£ã¦ã„ã†ã€ã‚ãªãŸã®å®—æ•™ï¼ˆæ„Ÿæƒ³ï¼‰ã®è©±ã§ã™ã‚ˆã­ï¼Ÿ",
            "ãã®è«–ç†ä½“ç³»ãŒç„¡çŸ›ç›¾ã§ã‚ã‚‹ã£ã¦ã„ã†è¨¼æ˜ã€ãã®å¤–å´ã®æ„Ÿæƒ³ãŒãªã„ã¨ã§ããªã„ã£ã¦ã‚²ãƒ¼ãƒ‡ãƒ«ãŒè¨€ã£ã¦ãŸã¨æ€ã†ã‚“ã§ã™ã‘ã©ã€‚",
            "è‡ªåˆ†ã®æ­£ã—ã•ã‚’è‡ªåˆ†ã§è¨¼æ˜ã—ã‚ˆã†ã¨ã™ã‚‹ã®ã£ã¦ã€ãŸã ã®å¾ªç’°è«–æ³•ã§ã™ã‚ˆã­ï¼Ÿ",
            "ã‚ãªãŸãŒãã‚Œã‚’ã€æ­£ã—ã„ã€ã£ã¦æ€ã„è¾¼ã‚“ã§ã‚‹äº‹å®Ÿã¯èªã‚ã¾ã™ã‘ã©ã€å®¢è¦³çš„ãªçœŸç†ã§ã¯ãªã„ã§ã™ã‚ˆã­ã€‚",
            "ãã‚Œã€ã©ã“ã®çµ±è¨ˆã§ã™ã‹ï¼Ÿ ã‚‚ã—ã‹ã—ã¦ã‚ãªãŸã®è„³å†…ã®çµ±è¨ˆï¼Ÿ",
            "ãªã‚“ã‹ãã†ã„ã†ãƒ‡ãƒ¼ã‚¿ã‚ã‚‹ã‚“ã™ã‹ï¼Ÿ ãªã‘ã‚Œã°ãŸã ã®æ„Ÿæƒ³ã§ã™ã‚ˆã­ã€‚",
            "å˜˜ã¤ãã®ã‚„ã‚ã¦ã‚‚ã‚‰ã£ã¦ã„ã„ã§ã™ã‹ï¼Ÿ è¦‹ã¦ã¦æ¥ãšã‹ã—ã„ã§ã™ã‚ˆã€‚",
            "å®šç¾©ãŒæ›–æ˜§ãªè¨€è‘‰ã‚’ä¸¦ã¹ã¦æ­£ã—ã„ã£ã¦è¨€ã„å¼µã‚‹ã®ã€é ­æ‚ªã„æ„Ÿã˜ãŒã—ã¾ã™ã‘ã©å¤§ä¸ˆå¤«ã§ã™ã‹ï¼Ÿ",
            "å€‹äººã®ä¸»è¦³ã®è©±ã‚’ã•ã‚Œã¦ã‚‚å›°ã‚‹ã‚“ã™ã‚ˆã­ã€‚å®¢è¦³çš„ãªäº‹å®Ÿã€è©±ã›ã¾ã™ï¼Ÿ",
            "ã‚ã€ãã‚Œã£ã½ã„ã“ã¨è¨€ã£ã¦ã¾ã™ã‘ã©ã€çµå±€ä½•ã‚‚è¨¼æ˜ã§ãã¦ãªã„ã§ã™ã‚ˆã­ï¼Ÿ",
            "ãã‚Œã£ã¦ã‚ãªãŸã®æ„Ÿæƒ³ã§ã™ã‚ˆã­ï¼Ÿ ã¯ã„ã€è«–ç ´ã€‚",
            "è©±ã®å‰æãŒé–“é•ã£ã¦ã‚‹ã®ã§ã€ãã®å¾Œã®ç†å±ˆå…¨éƒ¨ç„¡é§„ã§ã™ã‚ˆï¼Ÿ",
            "ã‚ãƒ¼ã€å…¸å‹çš„ãªè«–ç†ç ´ç¶»ã§ã™ã­ã€‚é¢ç™½ã„ã§ã™ã‘ã©ã€‚",
            "è³ªå•ã«ç­”ãˆã¦ã‚‚ã‚‰ã£ã¦ã„ã„ã§ã™ã‹ï¼Ÿ é€ƒã’ã‚‹ã‚“ã§ã™ã‹ï¼Ÿ"
        ];

        // æ±ºç€ã‚³ãƒ¡ãƒ³ãƒˆ
        const FINAL_COMMENTS = {
            win: [
                "ã¯ã„ã€åƒ•ã®è² ã‘ã§ã„ã„ã§ã™ã‚ˆï¼ˆãƒ‹ãƒ¤ãƒ‹ãƒ¤ï¼‰",
                "ã‚ãƒ¼ã€ã¯ã„ã¯ã„ã€‚ã‚ãªãŸãŒæ­£ã—ã„ã£ã¦ã“ã¨ã«ã—ã¨ãã¾ã™ã‚ˆã€‚é¢å€’ãã•ã„ã‚“ã§ã€‚",
                "çã—ãã¾ã¨ã‚‚ãªã“ã¨è¨€ã„ã¾ã—ãŸã­ã€‚ã§ã‚‚æ˜æ—¥ã«ã¯æ°—ãŒå¤‰ã‚ã£ã¦ã‚‹ã¨æ€ã„ã¾ã™ã‘ã©ã€‚"
            ],
            lose: [
                "ã¯ã„ã€è«–ç†æ€§ã‚¼ãƒ­ã€‚ãŠç–²ã‚Œæ§˜ã§ã—ãŸãƒ¼ã€‚ã‚‚ã†å–‹ã‚‰ãªã„ã»ã†ãŒã„ã„ã§ã™ã‚ˆï¼Ÿ",
                "çµå±€ã€ãŸã ã®æ„Ÿæƒ³ã§ã—ãŸã­ã€‚æ™‚é–“ã®ç„¡é§„ã§ã—ãŸã€‚ãƒã‚¤ãƒã‚¤ã€‚",
                "è‡ªåˆ†ã®é–“é•ã„ã‚’èªã‚ã‚‰ã‚Œãªã„ã®ã£ã¦ã€ä¸€ç•ªæ¥ãšã‹ã—ã„ã“ã¨ã ã¨æ€ã£ã¦ã¾ã™ã‘ã©å¤§ä¸ˆå¤«ã§ã™ã‹ï¼Ÿ"
            ]
        };

        function updateScore(delta) {
            logicScore = Math.max(0, Math.min(100, logicScore + delta));
            logicMeter.style.width = `${logicScore}%`;
            scoreText.textContent = logicScore;

            if (logicScore < 30) {
                logicMeter.className = 'h-full bg-red-500 meter-fill';
                scoreText.className = 'text-2xl font-bold text-red-500';
            } else if (logicScore < 75) {
                logicMeter.className = 'h-full bg-yellow-500 meter-fill';
                scoreText.className = 'text-2xl font-bold text-yellow-500';
            } else {
                logicMeter.className = 'h-full bg-emerald-500 meter-fill';
                scoreText.className = 'text-2xl font-bold text-emerald-500';
            }

            if (logicScore <= 0 || logicScore >= 100) {
                endGame(logicScore >= 100);
            }
        }

        function addMessage(text, isUser = false) {
            const div = document.createElement('div');
            div.className = isUser ? 'bubble-user chat-bubble text-sm' : 'bubble-hiroyuki chat-bubble text-sm shadow-sm';
            div.textContent = text;
            chatWindow.appendChild(div);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        async function hiroyukiStep(text) {
            if (isGameOver) return;
            
            typingIndicator.classList.remove('hidden');
            chatWindow.scrollTop = chatWindow.scrollHeight;
            statusText.textContent = "HIROYUKI ANALYZING...";

            // æ€è€ƒæ¼”å‡º
            await new Promise(r => setTimeout(r, 1200 + Math.random() * 800));
            typingIndicator.classList.add('hidden');

            // è«–ç†ã‚¹ã‚³ã‚¢è¨ˆç®— (ç°¡æ˜“ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ )
            let delta = -5; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯æ¸›ç‚¹ï¼ˆã²ã‚ã‚†ãä»•æ§˜ï¼‰
            
            if (text.includes("çµ±è¨ˆ") || text.includes("ãƒ‡ãƒ¼ã‚¿") || text.includes("è¨¼æ‹ ") || text.includes("äº‹å®Ÿ")) delta += 15;
            if (text.includes("å®šç¾©") || text.includes("å…¬ç†") || text.includes("å®¢è¦³çš„")) delta += 12;
            if (text.length > 30) delta += 8;
            if (text.includes("æ€ã†") || text.includes("æ°—ãŒã™ã‚‹") || text.includes("æ„Ÿæƒ³")) delta -= 20;
            if (text.length < 5) delta -= 10;
            
            // ãƒ©ãƒ³ãƒ€ãƒ è¦ç´ ï¼ˆã²ã‚ã‚†ãã®æ°—åˆ†ï¼‰
            delta += Math.floor(Math.random() * 11) - 5;

            const response = HIROYUKI_PHRASES[Math.floor(Math.random() * HIROYUKI_PHRASES.length)];
            addMessage(response);
            updateScore(delta);
            
            if (!isGameOver) {
                statusText.textContent = "WAITING FOR USER...";
            }
        }

        function endGame(userWins) {
            isGameOver = true;
            statusText.textContent = "BATTLE CONCLUDED";
            
            const resultEmoji = document.getElementById('result-emoji');
            const resultTitle = document.getElementById('result-title');
            const resultComment = document.getElementById('result-comment');
            
            if (userWins) {
                resultEmoji.textContent = "ğŸ†";
                resultTitle.textContent = "ã‚ãªãŸã®å‹åˆ©ï¼";
                resultTitle.className = "text-3xl font-bold mb-4 text-emerald-500";
                resultComment.textContent = FINAL_COMMENTS.win[Math.floor(Math.random() * FINAL_COMMENTS.win.length)];
            } else {
                resultEmoji.textContent = "ğŸ’€";
                resultTitle.textContent = "è«–ç ´ã•ã‚Œã¾ã—ãŸ";
                resultTitle.className = "text-3xl font-bold mb-4 text-red-500";
                resultComment.textContent = FINAL_COMMENTS.lose[Math.floor(Math.random() * FINAL_COMMENTS.lose.length)];
            }

            setTimeout(() => {
                gameOverOverlay.classList.remove('hidden');
            }, 1000);
        }

        function resetGame() {
            logicScore = 30;
            isGameOver = false;
            chatWindow.innerHTML = `
                <div class="bubble-hiroyuki chat-bubble leading-relaxed">
                    ãªã‚“ã‹é©å½“ã«è©±ã—ã¦ã¿ã¦ãã ã•ã„ã€‚<br>
                    ã‚ãªãŸã®è©±ã€ã ã„ãŸã„çŸ›ç›¾ã—ã¦ã‚‹ã¨æ€ã†ã‚“ã§ã™ã‘ã©ã€‚
                </div>
            `;
            updateScore(0);
            gameOverOverlay.classList.add('hidden');
            statusText.textContent = "DEBATE_PHASE: ACTIVE";
        }

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            if (isGameOver) return;

            const text = userInput.value.trim();
            if (!text) return;

            addMessage(text, true);
            userInput.value = '';
            
            hiroyukiStep(text);
        });

        // åˆæœŸãƒ­ãƒ¼ãƒ‰
        updateScore(0);
    </script>
</body>
</html>
